library IEEE;
USE IEEE.std_logic_1164.ALL;
USE IEEE.numeric_std.ALL;
USE IEEE.math_real.ALL;

ENTITY HW5A IS
GENERIC(len_in: POSITIVE := 16);
PORT (input: IN std_logic_vector (len_in-1 DOWNTO 0);
		hamming_weight: OUT std_logic_vector (integer(ceil(log2(real(len_in+1))))-1 DOWNTO 0));
END ENTITY;

ARCHITECTURE concurrent OF HW5A IS
	CONSTANT len_out: POSITIVE := integer(ceil(log2(real(len_in+1))));
	TYPE integer_array is array (0 to len_in) of integer range 0 to len_in;
	SIGNAL internal: integer_array;
BEGIN
	internal(0) <= 0;
	HammWeightCalc: for i in 1 to len_in GENERATE
		internal (i) <= internal(i-1) + 1 when input(i-1) = '1' else internal(i-1);
	END GENERATE;
	hamming_weight <= std_logic_vector(to_unsigned(internal(len_in), len_out));
END ARCHITECTURE;